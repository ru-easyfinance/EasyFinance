(function(a){a.fn.timePicker=function(b){var c={step:30,startTime:"08:00",endTime:"18:00",columns:4};a.extend(c,b);this.each(function(){var e=this;var h=a("<div class='time-holder'></div>");var d=[];var g=a.timePicker._timeStringToDate(c.startTime);var m=a.timePicker._timeStringToDate(c.endTime);while(g<=m){d[d.length]=jQuery.timePicker._formatTime(g);g=new Date(g.setMinutes(g.getMinutes()+c.step))}var j=a(document.createElement("table")).attr("class","times");var n=a(document.createElement("tr"));var l=false;for(var k=0;k<d.length;k++){l=false;n.append("<td class='time'>"+d[k]+"</td>");if(k%c.columns==c.columns-1){j.append(n);l=true;n=a(document.createElement("tr"))}}var f=n.find("td").size();if(f!=c.columns){var k=f;do{n.append("<td class='empty'></td>");k++}while(k!=c.columns)}if(!l){j.append(n)}h.append(j);a(e).after(h);if(jQuery.fn.below){h.below(e).hide()}a("td.time",h).hover(function(){a(this).parents("table:eq(0)").find("td").removeClass("selected").end().end().addClass("selected")},function(){a(this).removeClass("selected")}).click(function(){e.value=a(this).text();a(this).parents("div.time-holder").hide()}).removeClass("selected")}).click(function(f){var d=a(this).next("div.time-holder");a("div.time-holder").not(d).hide();d.toggle();if(this.value){}f.stopPropagation()});a("body").click(function(){a("div.time-holder").hide()});return this};a.timePicker={_formatTime:function(b){if(b&&b.constructor==Date){return b.toUTCString().match(/\d{2}:\d{2}/)}throw"not a valid date"},_timeStringToDate:function(d){var e;if(typeof d!="string"){e="a string must be supplied"}else{if(d.match(/^\d{2}:\d{2}$/)){var g=d.split(":");var b=parseFloat(g[0]);var f=parseFloat(g[1]);f+=b*60;var c=new Date();c.setTime(f*60*1000);return c}else{e="not a valid time string - should be in 24 hour format, i.e. 15:00"}}if(e){throw e}}}})(jQuery);