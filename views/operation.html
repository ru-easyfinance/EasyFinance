{* $Id$ *}
<h3>Операции по счету</h3>
<div id="form">
    <div class="field" id="account_fields">
       <label for="account">Счёт:</label>
        <select id="account">
            {foreach from=$accounts item=acc_data}
            <option value="{$acc_data.account_id}" currency="{$acc_data.account_currency_id}" abbr="{$acc_data.account_currency_name}">{$acc_data.account_name}</option>
            {/foreach}
        </select>
       <input type="button" id="btn_EditAccount" value="Редактировать счет" />
    </div>
    <div class="field" id="type_fields">
       <label for="type">Тип операции:</label>
        <select name="type" id="type">
            <option value="0">Расход</option>
            <option value="1">Доход</option>
            <option value="2">Перевод со счета</option>
            {*<!-- <option value="3">Покупка валюты</option> -->*}
            <option value="4">Перевод на финансовую цель</option>
        </select>
    </div>
    <div class="field" id="amount_fields">
       <label for="amount">Сумма:</label>
       <input type="text" id="amount">
    </div>
    <div class="field" id="category_fields">
       <label for="category">Категория:</label>
        {if !empty($list)}
        <select id="category">
            {if !empty($often)}
            <optgroup id="often" label="&nbsp;Часто используемые">
            {foreach from=$often item=data}
                <option value="{$data.cat_id}">{$data.cat_name}</option>
            {/foreach}
            </optgroup>
            {/if}
            <optgroup id="all" label="&nbsp;Все категории">
                {$category}
            </optgroup>
        </select>
        {else}
        <select id="category">
            {$category}
        </select>
        {/if}
    </div>
    {* <!-- Финансовая цель --> *}
    <div class="field" id="target_fields" style="display:none;">
       <label for="target">Финансовая цель:</label>
        <select id="target">
            <option bill="0" value="0" target_account_id='0' amount_done='0' percent_done='0'
                    forecast_done='0' amount="0"> -- Все -- </option>
            {foreach from=$targetList item=target}
                <option bill="{$target.target_account_id}" value="{$target.id}"
                    target_account_id='{$target.target_account_id}' amount_done='{$target.amount_done}'
                    percent_done='{$target.percent_done}' forecast_done='{$target.forecast_done}' amount={$target.amount}
                    {if $target.id==$target_sel}selected{/if}>
                    {$target.title|stripslashes|truncate:50:".."}</option>
            {/foreach}
        </select>
        <div>
            <div>Стоимость цели: <span id='amount_target'/><span class='currency'/></div>
            <div>Сумма накопленная: <span id='amount_done' /><span class='currency' /></div>
            <div>Прогноз: <span id='forecast_done'></span> %</div>
            <div>Процент готовности: <span id='percent_done'></span> %</div>
        </div>
        <input type="checkbox" id="close" name="close" value="Закрытая финансовая цель" />
        <label for="close">Закрытая финансовая цель</label>
    </div>
    {*<!-- Трансфер -->*}
    <div class="field" id="transfer_fields" style="display:none;">
        <label for="target">На счет:</label>
        <select id="AccountForTransfer">
            {foreach from=$accounts item=acc_data}
            <option value="{$acc_data.account_id}" currency="{$acc_data.account_currency_id}" abbr="{$acc_data.account_currency_name}">{$acc_data.account_name}</option>
            {/foreach}
        </select>
        <span id="operationTransferCurrency" style="display:none;">
            <span></span>
            <input type='text' id='currency'><span id="convertSumCurrency"></span>
        </span>
    </div>
    {*<!-- Основные поля -->*}
    <div class="field" id="date_fields">
        <label for="date">Дата:</label>
        <input type="text" value="{$date}" id="date">
    </div>
    <div class="field" id="comment_fields">
        <label for="target">Комментарий:</label>
        <textarea rows="4" cols="50" name="comment" id="comment"></textarea>
    </div>
    <div class="field" id="tags_fields">
        <label for="tags">Теги:</label>
        <input type="text" value="{$tags}" id="tags">
    </div>
    <div class="field">
        <input type="button" value="Сохранить" id="btn_Save">
        <input type="button" value="Отменить" id="btn_Cancel" >
    </div>
</div>
{*<!-- Фильтр -->*}
<div id="filtr">
    с: <input type="text" value="{$dateFrom}" name="dateFrom" id="dateFrom">&nbsp;
    по: <input type="text" value="{$dateTo}" name="dateTo" id="dateTo">&nbsp;&nbsp;
    категория:
    <select id="cat_filtr">
        <option label="Все" value=""> --- Все ---</option>
        {$cat_filtr}
    </select>
    &nbsp;&nbsp;
    <input type="button" value="Обновить данные" id="btn_ReloadData"/>
</div>
<div id="list"></div>